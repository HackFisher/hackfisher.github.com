--- 
layout: post
title: !binary |
  44CQ6Laj5ZGzSGFja+OAkVRyeTJoYWNrLm5s56ys5LqU5YWz5ZKM56ys5YWt
  5YWz

published: true
meta: 
  _edit_last: "1"
  _wp_old_slug: "%e3%80%90%e8%b6%a3%e5%91%b3hack%e3%80%91try2hack-nl%e7%ac%ac%e4%ba%94%e5%85%b3%e5%92%8c%e7%ac%ac%e5%85%ad%e5%85%b3"
  _oembed_d2478e6a2ce0813638444745bfa34152: "{{unknown}}"
tags: 
- Hack
- VB
- !binary |
  5Y+N57yW6K+R

- !binary |
  6Laj5ZGzSGFjaw==

type: post
status: publish
---
<strong>第五关</strong>地址：

http://www.try2hack.nl/levels/level5-fdvbdf.xhtml

a. 提示下载一个Visual Basic 3.0程序，运行之提示输入用户名密码。

b. 先尝试反编译之，vb3的程序似乎比vb5, vb6好反编译一些，找到一个好用的反编译软件Dodi，<a href="http://download.csdn.net/down/3011468/zjx20" target="_blank">下载地址</a>。反编译LEVEL5.EXE，得到LEVEL5.BAS代码
<pre escaped="true" lang="vb" line="1">' LEVEL5.FRM
Option Explicit
Sub cmdLogin_Click ()
If  edtUsername = Mid(gc0006, 56, 1) &amp; Mid(gc0006, 28, 1) &amp; Mid(gc0006, 35, 1) &amp; Mid(gc0006, 3, 1) &amp; Mid(gc0006, 44, 1) &amp; Mid(gc0006, 11, 1) &amp; Mid(gc0006, 13, 1) &amp; Mid(gc0006, 21, 1) Then
If  edtPassword = Mid(gc0006, 45, 1) &amp; Mid(gc0006, 48, 1) &amp; Mid(gc0006, 25, 1) &amp; Mid(gc0006, 32, 1) &amp; Mid(gc0006, 15, 1) &amp; Mid(gc0006, 40, 1) &amp; Mid(gc0006, 25, 1) &amp; Mid(gc0006, 14, 1) &amp; Mid(gc0006, 19, 1) Then
MsgBox "Level 6 can be found at: " &amp; Left$(gc000A, 37) &amp; Mid(gc0006, 21, 1) &amp; Mid(gc0006, 14, 1) &amp; Mid(gc0006, 29, 1) &amp; Mid(gc0006, 32, 1) &amp; Mid(gc0006, 12, 1) &amp; Mid(gc0006, 14, 1) &amp; Mid(gc000A, 44, 6), 0, "Horray!"
End
End If
End If
MsgBox "Invalid username and/or password!", 0, "ERROR!"
End Sub
Sub Form_Load ()
Me.Move (Screen.Width - Me.Width) / 2, (Screen.Height - Me.Height) / 2
End Su
' LEVEL5.FRMOption Explicit
Sub cmdLogin_Click ()If  edtUsername = Mid(gc0006, 56, 1) &amp; Mid(gc0006, 28, 1) &amp; Mid(gc0006, 35, 1) &amp; Mid(gc0006, 3, 1) &amp; Mid(gc0006, 44, 1) &amp; Mid(gc0006, 11, 1) &amp; Mid(gc0006, 13, 1) &amp; Mid(gc0006, 21, 1) Then  If  edtPassword = Mid(gc0006, 45, 1) &amp; Mid(gc0006, 48, 1) &amp; Mid(gc0006, 25, 1) &amp; Mid(gc0006, 32, 1) &amp; Mid(gc0006, 15, 1) &amp; Mid(gc0006, 40, 1) &amp; Mid(gc0006, 25, 1) &amp; Mid(gc0006, 14, 1) &amp; Mid(gc0006, 19, 1) Then    MsgBox "Level 6 can be found at: " &amp; Left$(gc000A, 37) &amp; Mid(gc0006, 21, 1) &amp; Mid(gc0006, 14, 1) &amp; Mid(gc0006, 29, 1) &amp; Mid(gc0006, 32, 1) &amp; Mid(gc0006, 12, 1) &amp; Mid(gc0006, 14, 1) &amp; Mid(gc000A, 44, 6), 0, "Horray!"    End  End IfEnd IfMsgBox "Invalid username and/or password!", 0, "ERROR!"End Sub
Sub Form_Load ()Me.Move (Screen.Width - Me.Width) / 2, (Screen.Height - Me.Height) / 2End Su</pre>
c. Mid是VB的库函数，没有VB也没关系，逻辑是一样的，用其他语言实现一下，处理的字符串在MAIN.TXT里，可得到结果。关键知道反编译成功就行了。

<strong>第六关</strong>地址：http://www.try2hack.nl/levels/level6-kdsvbd.xhtml

a. 打开网页，同样是VB程序，但是是Visual Basic 6.0的。先看看能不能反编译，试了一下第五关的Dodi，已经不管用了。到网上找了很久，感觉有，但是很多是商业版而且不知道管不管用。所以就打算从其他地方入手。

b. 运行LEVEL6.EXE，随便输入用户名密码，确定，嘿，发现连接了网络读取数据，这下有招了。

<a href="{{ BASE_PATH }}/uploads/2011/02/level6_exe.png"><img class="aligncenter size-full wp-image-114" title="level6_exe" src="{{ BASE_PATH }}/uploads/2011/02/level6_exe.png" alt="" width="471" height="330" /></a>c. 还记得<a href="http://www.hackfisher.info/blog/?p=68" target="_blank">如何在咖啡厅，网吧等公共场所要到漂亮MM的QQ号</a>这篇文章了，那里用到了网络抓取工具<span style="color: #333333; font-family: Georgia, 'Times New Roman', Times, serif; line-height: 26px;"><a style="text-decoration: underline; color: #772124;" title="Wireshark" href="http://www.wireshark.org/" target="_blank">Wireshark软件</a>。这里我们也可以派上用场。首先获得try2hack.nl的ip，wireshark下设置过滤"host 217.195.122.51"，再测试一下，捕捉获得如下信息。</span>

<span style="color: #333333; font-family: Georgia, 'Times New Roman', Times, serif; line-height: 26px;"><a href="{{ BASE_PATH }}/uploads/2011/02/level6_capture.png"><img class="aligncenter size-full wp-image-115" title="level6_capture" src="{{ BASE_PATH }}/uploads/2011/02/level6_capture.png" alt="" width="685" height="379" /></a>d. 将level6.data下载下来，获得如下文本：</span>

&nbsp;
<pre escaped="true" lang="php" line="1">(ENCRYPTION TYPE)

B*C*N**N

(USERNAME)

aaabb aaaaa aaaab abbab ababb aaaab

(PASSWORD)

aabaa abbaa aaaba baaaa babba abbba baaba abaaa abbab abbaa baaaa aaaaa babaa abaab baaab

(PAGE)

babab aabab abaab abbab aabbb aaaba</pre>
&nbsp;

<span style="font-family: Georgia, 'Times New Roman', Times, serif; color: #333333;"><span style="line-height: 26px;">e. 简单的Google搜索"B*C*N**N ENCRYPTION"后(google的技巧，*通配符要加引号)，获得如下链接</span></span>

<span style="font-family: Georgia, 'Times New Roman', Times, serif; color: #333333;"><span style="line-height: 26px;">http://www.bbc.co.uk/dna/h2g2/A9837183</span></span>

<span style="font-family: Georgia, 'Times New Roman', Times, serif; color: #333333;"><span style="line-height: 26px;">说明这是种编码方式，叫Baconian Cipher，写程序解码eve6.data得到用户名，密码和下一关的地址。</span></span>

&nbsp;
<pre escaped="true" lang="java" line="1">public class BaconianCypher {

	/**

	 * @param args

	 */

	public static void main(String[] args) {

		String[] a = new String[] {

				"aaaaa", "aaaab", "aaaba", "aaabb", "aabaa", "aabab", "aabba", "aabbb", "abaaa",

				           "abaaa", "abaab", "ababa", "ababb", "abbaa", "abbab", "abbba", "abbbb", "baaaa",

				           "baaab", "baaba", "baabb", "baabb", "babaa", "babab", "babba", "babbb"

		};

		char[] digits = { 'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z' };

		java.util.Map cypherMap = new java.util.HashMap();

		for (int i = 0; i &lt; a.length; i ++) {

			cypherMap.put(a[i], digits[i]);

		}

		System.out.println(decode(new String[] {"aaabb", "aaaaa", "aaaab", "abbab", "ababb", "aaaab"}, cypherMap));

		System.out.println(decode(new String[] {"aabaa", "abbaa", "aaaba", "baaaa", "babba", "abbba", "baaba", "abaaa", "abbab", "abbaa", "baaaa", "aaaaa", "babaa", "abaab", "baaab"}, cypherMap));

		System.out.println(decode(new String[] {"babab", "aabab", "abaab", "abbab", "aabbb", "aaaba"}, cypherMap));

	}

	public static String decode(String[] txt, java.util.Map map) {

		StringBuffer sb = new StringBuffer();

		for (int i = 0; i &lt; txt.length; i ++) {

			sb.append(map.get(txt[i]));

		}

		return sb.toString().toLowerCase();

	}

}</pre>
参考资料：

1. http://www.woodmann.com/crackz/Tools.htm

2. http://www.program-transformation.org/Transform/VisualBasicDecompilers
